<!DOCTYPE html>
<!--suppress HtmlFormInputWithoutLabel -->
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!--suppress HtmlUnknownTarget -->
  <link rel="icon" href="/favicon.ico" type="image/x-icon" />
  <title>Much Select</title>
  <link href="demo-styles.css" rel="stylesheet">
  <script src="/options.js"></script>
</head>

<body>

<h1>Much-Select</h1>

<h2>Demo and Development Playground</h2>

<nav>
  <ol class="main-nav">
    <li class="main-nav-item"><a href="initial-value.html">Initial Value</a></li>
    <li class="main-nav-item"><a href="option-api.html">Option API</a></li>
    <li class="main-nav-item"><a href="events.html">Events</a></li>
    <li class="main-nav-item"><a href="empty-options.html">Empty Options</a></li>
    <li class="main-nav-item"><a href="dropdown-options.html">Dropdown Options</a></li>
    <li class="main-nav-item"><a href="fancy-characters.html">Fancy Characters</a></li>
    <li class="main-nav-item"><a href="custom-options.html">Custom Options</a></li>
    <li class="main-nav-item"><a href="slots.html">Slots</a></li>
    <li class="main-nav-item"><a href="multi-select.html">Multi Select</a></li>
  </ol>
</nav>

<div class="container">

  <div>
    <h3>Simple Example</h3>
    <much-select>
      <select slot="select-input">
        <option>Bricks</option>
        <option>Sticks</option>
        <option>Straw</option>
      </select>
    </much-select>
  </div>

  <div>
    <h3>Multi Select</h3>
    <much-select multi-select="true">
      <select slot="select-input">
        <option>Red</option>
        <option>Yellow</option>
        <option>Orange</option>
        <option>Green</option>
        <option>Blue</option>
        <option>Purple</option>
      </select>
    </much-select>
  </div>

  <div>
    <h3>Option Groups</h3>
    <much-select>
      <select slot="select-input">
        <optgroup label="Primary">
          <option>Red</option>
          <option>Yellow</option>
          <option>Blue</option>
        </optgroup>
        <optgroup label="Secondary">
          <option>Orange</option>
          <option>Green</option>
          <option>Purple</option>
        </optgroup>
      </select>
    </much-select>
  </div>

  <div>
    <h3>Options with Descriptions</h3>
    <much-select>
      <select slot="select-input">
        <option data-description="scarlet, vermilion, ruby, ruby red, ruby-colored, cherry">Red</option>
        <option data-description="yellowish, yellowy, lemon, lemony, amber, gold, golden; blond, light brown, fair, flaxen">Yellow</option>
        <option data-description=" sky blue, azure, cobalt (blue), sapphire, cerulean, navy (blue), saxe (blue), Oxford blue, Cambridge blue, ultramarine">Blue</option>
        <option data-description="A town in France">Orange</option>
        <option data-description="greenish, viridescent; olive green, pea green, emerald green, lime green, bottle green">Green</option>
        <option data-description="violet">Purple</option>
      </select>
    </much-select>
  </div>

  <div>
    <h3>Options Label and Values</h3>
    <p>The labels and values are different</p>
    <much-select>
      <select slot="select-input">
        <option value="monkey">üêí</option>
        <option value="tree">üå≥</option>
        <option value="panda">üêº</option>
        <option value="ladybug">üêû</option>
        <option value="butterfly">ü¶ã</option>
        <option value="rabbit">üêá</option>
      </select>
    </much-select>
  </div>

  <div>
    <h3>An initial value</h3>
    <p>Set using the <code>selected</code> attribute on the <code>&lt;much-select&gt;</code></p>
    <much-select selected-value="Blue">
      <select slot="select-input">
        <option data-description="scarlet, vermilion, ruby, ruby red, ruby-colored, cherry">Red</option>
        <option data-description="yellowish, yellowy, lemon, lemony, amber, gold, golden; blond, light brown, fair, flaxen">Yellow</option>
        <option data-description=" sky blue, azure, cobalt (blue), sapphire, cerulean, navy (blue), saxe (blue), Oxford blue, Cambridge blue, ultramarine">Blue</option>
        <option data-description="A town in France">Orange</option>
        <option data-description="greenish, viridescent; olive green, pea green, emerald green, lime green, bottle green">Green</option>
        <option data-description="violet">Purple</option>
      </select>
    </much-select>
  </div>

  <div>
    <h3>A Placeholder</h3>
    <much-select placeholder="What is your favorite color?">
      <select slot="select-input">
        <option data-description="scarlet, vermilion, ruby, ruby red, ruby-colored, cherry">Red</option>
        <option data-description="yellowish, yellowy, lemon, lemony, amber, gold, golden; blond, light brown, fair, flaxen">Yellow</option>
        <option data-description=" sky blue, azure, cobalt (blue), sapphire, cerulean, navy (blue), saxe (blue), Oxford blue, Cambridge blue, ultramarine">Blue</option>
        <option data-description="A town in France">Orange</option>
        <option data-description="greenish, viridescent; olive green, pea green, emerald green, lime green, bottle green">Green</option>
        <option data-description="violet">Purple</option>
      </select>
    </much-select>
  </div>

  <div>
    <h3>Disabled</h3>
    <p>Disable the <code>&lt;much-select&gt;</code> with the <code>disabled</code> attribute.</p>
    <much-select disabled="disabled">
      <select slot="select-input">
        <option>Red</option>
        <option>Yellow</option>
        <option>Blue</option>
        <option>Orange</option>
        <option>Green</option>
        <option>Purple</option>
      </select>
    </much-select>
  </div>

  <div id="loading-indicator">
    <h3>Loading</h3>
    <p>Show and hide the loading indicator with the <code>loading</code> attribute.</p>
    <much-select loading="loading">
      <select slot="select-input">
        <option>Red</option>
        <option>Yellow</option>
        <option>Blue</option>
        <option>Orange</option>
        <option>Green</option>
        <option>Purple</option>
      </select>
    </much-select>
    <button>Toggle loading attribute</button>
    <script>
      document.querySelector("#loading-indicator button").addEventListener("click", () => {
        const muchSelectElement = document.querySelector("#loading-indicator much-select");
        if (muchSelectElement.hasAttribute("loading")) {
          muchSelectElement.removeAttribute("loading");
        } else {
          muchSelectElement.setAttribute("loading", "loading");
        }

      });
    </script>
  </div>

  <div>
    <h3>Disabled Options</h3>
    <p>This has a disabled "yellow" option.</p>
    <much-select>
      <select slot="select-input">
        <option>Red</option>
        <option disabled>Yellow</option>
        <option>Blue</option>
        <option disabled>Orange</option>
        <option>Green</option>
        <option>Purple</option>
      </select>
    </much-select>
  </div>


  <div>
    <h3>Change Options With the Dom</h3>
    <button id="change-the-dom">Click me to change the dom</button>
    <much-select id="change-the-dom-much-select">
      <select id="change-the-dom-select" slot="select-input">
        <option value="1">These</option>
        <option value="2">are</option>
        <option value="3" data-description="initial options">the</option>
        <option value="4" data-description="them by changing the dom">Replace</option>
      </select>
    </much-select>
    <script>
      document.getElementById("change-the-dom").addEventListener("click", () => {
        document.getElementById("change-the-dom-much-select").innerHTML = `
          <select id="change-the-dom-select" slot="select-input">
            <option value="100">New</option>
            <option value="200">options</option>
            <option value="3" data-description="here">are</option>
            <option value="4">Hurray!</option>
          </select>
        `;
      });
    </script>
  </div>

  <div>
    <h3>Max Number of Items</h3>
    <much-select max-dropdown-items="3">
      <select slot="select-menu-input">
        <option value="1">These</option>
        <option value="2">are</option>
        <option value="3" data-description="initial options">the</option>
        <option value="4" data-description="them by changing the dom">Replace</option>
      </select>
    </much-select>
  </div>

  <div id="remote-api-example">
    <h3>Remote API</h3>
    <p>As you type we'll query the remote API for additional options.</p>
    <p>This dropdown searches the <a href="https://rickandmortyapi.com/">Rick and Morty</a> API for characters from the show by name.</p>
    <much-select max-dropdown-items="3">
      <select slot="select-menu-input"></select>
    </much-select>

    <script>
      (() => {
        const muchSelect = document.querySelector("#remote-api-example much-select");

        muchSelect.addEventListener("inputKeyUpDebounced", evt => {
          const searchString = evt.detail.searchString;
          if (searchString.length < 3) {
            // Lets not search unless we have at least 3 characters in the search string.
            return;
          }
          const url = new URL("https://rickandmortyapi.com/api/character/");
          url.searchParams.set("name", searchString);
          const searchRequest = new Request(url.toString());

          // This could take a while, so the user knows something is going on
          //  lets throw up the loading indicator.
          muchSelect.loading = true;

          const searchRickAndMortyCharactersByName = () => {
            fetch(searchRequest)
              .then(response => {
                if (!response.ok) {
                  throw new Error(`HTTP error! status: ${response.status}`)
                }
                return response.json()
              })
              .then(data => {
                data.results.forEach(result => {
                  muchSelect.addOption({value: result.name});
                });
                muchSelect.loading = false;
              })
          }

          // The API is just too fast, slow it down a bit so we can watch
          //  it work.
          window.setTimeout(searchRickAndMortyCharactersByName, 2000);
        })
      })();
    </script>
  </div>

  <div id="selected-option-with-async-options">
    <h3>Async Loading Options</h3>
    <p>In this example we start with a single selected value, then asynchronously load in a bunch more options.</p>
    <p>The description for the selected gets loaded in with all async options.</p>
    <much-select max-dropdown-items="30">
      <select slot="select-menu-input">
        <option selected="true" value="les Escaldes">les Escaldes</option>
      </select>
    </much-select>

    <script>
      (() => {
        const muchSelect = document.querySelector(
          "#selected-option-with-async-options much-select"
        );
        let possibleOptions = window.much_select_options;

        const searchForOptions = (searchString) => {
          return () => {
            // only searching against label. description should be searchable at some point.
            possibleOptions
              .filter((opt) => opt.label.includes(searchString))
              .forEach((opt) => {
                muchSelect.addOption(opt);
              });
            setTimeout(function() {
              muchSelect.loading = false;
            }, 500);
          };
        };

        muchSelect.addEventListener("ready", (evt) => {
          if (
            muchSelect.getAttribute("selected") &&
            muchSelect.getAttribute("selected").length > 0
          ) {
            // search
            const query = muchSelect.getAttribute("selected");

            window.setTimeout(searchForOptions(query), 2000);
          } else {
            possibleOptions.forEach((option) => {
              muchSelect.addOption(option);
            });
          }
        });

        muchSelect.addEventListener("inputKeyUpDebounced", (evt) => {
          const searchString = evt.detail.searchString;
          if (searchString.length < 3) {
            // Lets not search unless we have at least 3 characters in the search string.
            return;
          }

          // This could take a while, so the user knows something is going on
          //  lets throw up the loading indicator.
          muchSelect.loading = true;

          // The API is just too fast, slow it down a bit so we can watch
          //  it work.
          window.setTimeout(searchForOptions(searchString), 2000);
        });
      })();
    </script>
  </div>

  <div id="custom-options-that-persist">
    <h3>Custom Options That Persist</h3>
    <much-select allow-custom-options="allow-custom-options">
      <select slot="select-menu-input">
        <option value="B√°nh m√¨">B√°nh m√¨</option>
        <option value="Cheesesteak">Cheesesteak</option>
        <option value="Cheesesteak">Po' boy</option>
      </select>
    </much-select>

    <script>
      (() => {
        const muchSelect = document.querySelector(
          "#custom-options-that-persist much-select"
        );

        muchSelect.addEventListener("muchSelectReady", () => {
          // We can't go adding options to the much select until it's good and ready.
          const localStorageKey = "custom-options-that-persist";

          const customOptionsAsString = window.localStorage.getItem(localStorageKey);
          if (customOptionsAsString === null) {
            // This is the first time we are seeing this, save an empty array
            //  for future custom options.
            const emptySetOfOptions = [];
            const emptySetOfOptionString = JSON.stringify(emptySetOfOptions);
            window.localStorage.setItem(localStorageKey, emptySetOfOptionString)
          } else {
            // The table is set. We may have some custom options.
            const customOptions = JSON.parse(customOptionsAsString);
            muchSelect.addOptions(customOptions);
          }

          muchSelect.addEventListener("customValueSelected", (evt) => {
            const newValue = evt.detail.value;
            let customOptionsAsString = window.localStorage.getItem(localStorageKey);
            const customOptions = JSON.parse(customOptionsAsString);
            customOptions.push(newValue);
            customOptionsAsString = JSON.stringify(customOptions);
            window.localStorage.setItem(localStorageKey, customOptionsAsString);
          });
        })

      })();
    </script>
  </div>


  <div id="events-only-mode">
    <h3>Events Only Mode</h3>
    <p>
      The <code>events-only=""</code> attribute is a little bit specialized, it
      is for when you are in a situation where something else <em>really</em>
      wants to have full control over the DOM. Elm would an example of this. In
      this case, we only want the <code>much-select</code> element to emmit events
      and leave it up to "something else" to managed its attributes.
    </p>
    <much-select events-only="" selected-value="central">
      <select slot="select-menu-input">
        <option value="Eastern">Eastern</option>
        <option value="central">Central</option>
        <option value="mountain">Mountain</option>
        <option value="western">Western</option>
      </select>
    </much-select>
  </div>

</div>

<script src="./index.js" type="module"></script>
</body>
</html>
